services:
  # Frontend (Static Site)
  - type: web
    name: reservacancha-frontend
    env: static
    staticPublishPath: ./frontend/dist/reservacancha-frontend 
    # The build command needs to be run from the frontend directory
    buildCommand: "cd frontend && npm install && npm run build"
    routes:
      - type: rewrite
        source: /*
        destination: /index.html
  # Backend (Web Service)
  - type: web
    name: reservacancha-backend
    env: docker
    dockerfilePath: backend/Dockerfile
    dockerContext: ./
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      - key: DATABASE_URL
        # DatabaseConfig convierte autom√°ticamente de postgresql:// a jdbc:postgresql://
        # IMPORTANTE: Usar la INTERNAL Database URL de Render (sin .ohio-postgres.render.com)
        value: postgresql://reservacancha:JjpQXMjIRkwVwLEnrbep3T3YmhJr1AhA@dpg-d5qf88c9c44c73d1tlag-a:5432/reservacancha
      - key: FRONTEND_URL
        # Actualizar con tu URL de frontend real
        value: https://reservacancha-frontend.onrender.com
