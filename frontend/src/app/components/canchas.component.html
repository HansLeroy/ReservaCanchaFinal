<div class="canchas-container">
  <!-- PatrÃ³n de fondo -->
  <div class="background-pattern"></div>

  <!-- BotÃ³n Volver -->
  <button class="btn-volver" (click)="volver()" type="button">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M19 12H5M5 12L12 19M5 12L12 5" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    Volver al Inicio
  </button>

  <!-- Header -->
  <div class="header">
    <div class="logo-container">
      <svg class="logo-icon" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
        <rect x="3" y="3" width="18" height="18" rx="2" stroke="currentColor" stroke-width="2"/>
        <path d="M3 9h18M9 3v18" stroke="currentColor" stroke-width="2"/>
      </svg>
      <h1>GestiÃ³n de Canchas</h1>
    </div>
    <p class="subtitle">Administra todas las canchas deportivas del centro</p>
  </div>

  <!-- Mensajes -->
  <div class="mensaje-exito" *ngIf="successMessage">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    {{ successMessage }}
  </div>

  <div class="mensaje-error" *ngIf="errorMessage">
    <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
      <path d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </svg>
    {{ errorMessage }}
  </div>

  <!-- Card Principal -->
  <div class="canchas-card">

    <!-- EstadÃ­sticas -->
    <div class="estadisticas-grid">
      <div class="stat-card stat-total">
        <div class="stat-icon">ğŸŸï¸</div>
        <div class="stat-info">
          <span class="stat-numero">{{ obtenerEstadisticas().total }}</span>
          <span class="stat-label">Total Canchas</span>
        </div>
      </div>

      <div class="stat-card stat-disponibles">
        <div class="stat-icon">âœ…</div>
        <div class="stat-info">
          <span class="stat-numero">{{ obtenerEstadisticas().disponibles }}</span>
          <span class="stat-label">Disponibles</span>
        </div>
      </div>

      <div class="stat-card stat-mantenimiento">
        <div class="stat-icon">ğŸ”§</div>
        <div class="stat-info">
          <span class="stat-numero">{{ obtenerEstadisticas().mantenimiento }}</span>
          <span class="stat-label">En Mantenimiento</span>
        </div>
      </div>

      <div class="stat-card stat-filtradas">
        <div class="stat-icon">ğŸ”</div>
        <div class="stat-info">
          <span class="stat-numero">{{ obtenerEstadisticas().filtradas }}</span>
          <span class="stat-label">Mostrando</span>
        </div>
      </div>
    </div>

    <!-- BotÃ³n Nueva Cancha -->
    <div class="acciones-principales">
      <button class="btn-nueva-cancha" (click)="abrirFormularioNueva()" type="button">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <path d="M12 5v14m-7-7h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        Nueva Cancha
      </button>
    </div>

    <!-- Formulario Crear/Editar -->
    <div class="formulario-cancha" *ngIf="mostrarFormulario">
      <div class="formulario-header">
        <h3>{{ modoEdicion ? 'âœï¸ Editar Cancha' : 'â• Nueva Cancha' }}</h3>
        <button class="btn-cerrar" (click)="cancelarFormulario()" type="button">âœ•</button>
      </div>

      <form (ngSubmit)="guardarCancha()">
        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Nombre de la Cancha *</label>
            <input
              type="text"
              class="form-input"
              [(ngModel)]="canchaActual.nombre"
              name="nombre"
              placeholder="Ej: Cancha FÃºtbol 5 - Los Pinos"
              required>
          </div>

          <div class="form-group">
            <label class="form-label">Tipo de Deporte *</label>
            <select
              class="form-input"
              [(ngModel)]="canchaActual.tipo"
              name="tipo"
              required>
              <option value="">Selecciona un deporte</option>
              <option *ngFor="let deporte of deportes" [value]="deporte">
                {{ obtenerIconoDeporte(deporte) }} {{ deporte }}
              </option>
            </select>
          </div>
        </div>

        <div class="form-row">
          <div class="form-group">
            <label class="form-label">Precio por Hora (CLP) *</label>
            <input
              type="number"
              class="form-input"
              [(ngModel)]="canchaActual.precioPorHora"
              name="precio"
              placeholder="25000"
              min="0"
              step="1000"
              required>
          </div>

          <div class="form-group">
            <label class="form-label">Estado</label>
            <div class="toggle-container">
              <label class="toggle-switch">
                <input
                  type="checkbox"
                  [(ngModel)]="canchaActual.disponible"
                  name="disponible">
                <span class="toggle-slider"></span>
              </label>
              <span class="toggle-label">
                {{ canchaActual.disponible ? 'âœ… Disponible' : 'ğŸ”§ En Mantenimiento' }}
              </span>
            </div>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label">DescripciÃ³n</label>
          <textarea
            class="form-textarea"
            [(ngModel)]="canchaActual.descripcion"
            name="descripcion"
            rows="3"
            placeholder="DescripciÃ³n de la cancha, caracterÃ­sticas, servicios incluidos, etc."></textarea>
        </div>

        <div class="form-actions">
          <button type="button" class="btn-cancelar" (click)="cancelarFormulario()">
            Cancelar
          </button>
          <button type="submit" class="btn-guardar" [disabled]="isLoading">
            <span *ngIf="!isLoading">{{ modoEdicion ? 'ğŸ’¾ Guardar Cambios' : 'â• Crear Cancha' }}</span>
            <span *ngIf="isLoading">
              <div class="spinner-small"></div> Guardando...
            </span>
          </button>
        </div>
      </form>
    </div>

    <!-- Filtros y BÃºsqueda -->
    <div class="filtros-container">
      <div class="filtros-row">
        <div class="filtro-grupo">
          <label>ğŸ” Buscar</label>
          <input
            type="text"
            class="filtro-input"
            [(ngModel)]="filtroBusqueda"
            (ngModelChange)="aplicarFiltros()"
            placeholder="Nombre, deporte, descripciÃ³n...">
        </div>

        <div class="filtro-grupo">
          <label>ğŸƒ Deporte</label>
          <select
            class="filtro-select"
            [(ngModel)]="filtroDeporte"
            (ngModelChange)="aplicarFiltros()">
            <option value="TODOS">Todos los Deportes</option>
            <option *ngFor="let deporte of deportes" [value]="deporte">
              {{ obtenerIconoDeporte(deporte) }} {{ deporte }}
            </option>
          </select>
        </div>

        <div class="filtro-grupo">
          <label>ğŸ“Š Estado</label>
          <select
            class="filtro-select"
            [(ngModel)]="filtroEstado"
            (ngModelChange)="aplicarFiltros()">
            <option value="TODOS">Todas</option>
            <option value="DISPONIBLES">âœ… Disponibles</option>
            <option value="MANTENIMIENTO">ğŸ”§ En Mantenimiento</option>
          </select>
        </div>

        <div class="filtro-grupo">
          <label>ğŸ”„ Ordenar por</label>
          <div class="ordenar-botones">
            <button
              class="btn-ordenar"
              [class.activo]="ordenarPor === 'nombre'"
              (click)="cambiarOrden('nombre')"
              type="button">
              Nombre {{ ordenarPor === 'nombre' ? (ordenAscendente ? 'â†‘' : 'â†“') : '' }}
            </button>
            <button
              class="btn-ordenar"
              [class.activo]="ordenarPor === 'tipo'"
              (click)="cambiarOrden('tipo')"
              type="button">
              Deporte {{ ordenarPor === 'tipo' ? (ordenAscendente ? 'â†‘' : 'â†“') : '' }}
            </button>
            <button
              class="btn-ordenar"
              [class.activo]="ordenarPor === 'precio'"
              (click)="cambiarOrden('precio')"
              type="button">
              Precio {{ ordenarPor === 'precio' ? (ordenAscendente ? 'â†‘' : 'â†“') : '' }}
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Spinner de carga -->
    <div class="spinner-center" *ngIf="isLoading && !mostrarFormulario">
      <div class="spinner-grande"></div>
      <p>Cargando canchas...</p>
    </div>

    <!-- Lista de Canchas -->
    <div class="canchas-grid" *ngIf="!isLoading">
      <div
        *ngFor="let cancha of canchasFiltradas"
        class="cancha-card"
        [class.cancha-inactiva]="!cancha.disponible">

        <div class="cancha-badge">
          <span class="badge-deporte">{{ obtenerIconoDeporte(cancha.tipo) }} {{ cancha.tipo }}</span>
          <span
            class="badge-estado"
            [class.estado-disponible]="cancha.disponible"
            [class.estado-mantenimiento]="!cancha.disponible">
            {{ cancha.disponible ? 'âœ… Disponible' : 'ğŸ”§ Mantenimiento' }}
          </span>
        </div>

        <div class="cancha-header">
          <h3 class="cancha-nombre">{{ cancha.nombre }}</h3>
          <div class="cancha-precio">
            <span class="precio-valor">${{ cancha.precioPorHora.toLocaleString('es-CL') }}</span>
            <span class="precio-unidad">/hora</span>
          </div>
        </div>

        <div class="cancha-descripcion" *ngIf="cancha.descripcion">
          <p>{{ cancha.descripcion }}</p>
        </div>

        <div class="cancha-acciones">
          <button
            class="btn-accion btn-editar"
            (click)="editarCancha(cancha)"
            type="button"
            title="Editar cancha">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Editar
          </button>

          <button
            class="btn-accion btn-estado"
            [class.btn-activar]="!cancha.disponible"
            [class.btn-desactivar]="cancha.disponible"
            (click)="cambiarEstadoCancha(cancha)"
            type="button"
            [title]="cancha.disponible ? 'Poner en mantenimiento' : 'Activar cancha'">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" *ngIf="cancha.disponible">
              <path d="M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" *ngIf="!cancha.disponible">
              <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            {{ cancha.disponible ? 'Desactivar' : 'Activar' }}
          </button>

          <button
            class="btn-accion btn-eliminar"
            (click)="eliminarCancha(cancha)"
            type="button"
            title="Eliminar cancha">
            <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
            </svg>
            Eliminar
          </button>
        </div>
      </div>

      <!-- Mensaje cuando no hay resultados -->
      <div class="sin-resultados" *ngIf="canchasFiltradas.length === 0">
        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
          <circle cx="11" cy="11" r="8" stroke="currentColor" stroke-width="2"/>
          <path d="M21 21l-4.35-4.35" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
        <h3>No se encontraron canchas</h3>
        <p>Intenta cambiar los filtros de bÃºsqueda</p>
      </div>
    </div>

  </div>
</div>

